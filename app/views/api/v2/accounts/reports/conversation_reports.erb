<%= CSVSafe.generate_line [I18n.t('reports.period', since: DateTime.strptime(params[:since], '%s').in_time_zone('Asia/Kolkata').to_date, until: DateTime.strptime(params[:until], '%s').in_time_zone('Asia/Kolkata').to_date)] %>

<% headers = [
  I18n.t('reports.conversation_report_csv.conversation_id'),
  I18n.t('reports.conversation_report_csv.inbox_name'),
  I18n.t('reports.conversation_report_csv.customer_name'),
  I18n.t('reports.conversation_report_csv.customer_phone_number'),
  I18n.t('reports.conversation_report_csv.customer_email'),
  I18n.t('reports.conversation_report_csv.customer_instagram_handle'),
  I18n.t('reports.conversation_report_csv.agent_name'),
  I18n.t('reports.conversation_report_csv.conversation_status'),
  I18n.t('reports.conversation_report_csv.first_response_time_minutes'),
  I18n.t('reports.conversation_report_csv.resolution_time_minutes'),
  I18n.t('reports.conversation_report_csv.labels')
] %>

<%= CSVSafe.generate_line headers %>
<% @report_data.each do |row| %>
  <%= CSVSafe.generate_line(row).html_safe %>
<% end %>
